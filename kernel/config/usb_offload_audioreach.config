# ============================================
# QCS6490 USB Audio Offload - 方向E 内核配置
# AudioReach/GPR 栈 + USB Offload
# ============================================
# 适用于应用了 patches/0001-0006 的内核
#
# 使用方法:
#   scripts/kconfig/merge_config.sh \
#       arch/arm64/configs/defconfig \
#       usb_offload_audioreach.config
#   make olddefconfig && make -j$(nproc)
# ============================================

# --- AudioReach/GPR 核心 ---
CONFIG_QCOM_APR=m
CONFIG_QCOM_GPR=m
CONFIG_SND_SOC_QCOM=m
CONFIG_SND_SOC_QDSP6=m
CONFIG_SND_SOC_QDSP6_COMMON=m
CONFIG_SND_SOC_QDSP6_APM=m
CONFIG_SND_SOC_QDSP6_APM_DAI=m
CONFIG_SND_SOC_QDSP6_APM_LPASS_DAI=m
CONFIG_SND_SOC_QDSP6_PRM=m
CONFIG_SND_SOC_QDSP6_PRM_LPASS_CLOCKS=m
CONFIG_SND_SOC_TOPOLOGY=y

# --- USB Offload 核心 ---
CONFIG_SND_SOC_QDSP6_USB=m
CONFIG_SND_SOC_USB=m
CONFIG_SND_SOC_QCOM_OFFLOAD_UTILS=m
CONFIG_SND_USB_AUDIO=m
CONFIG_USB_XHCI_SIDEBAND=y

# --- QMI 通信 ---
CONFIG_QCOM_QMI_HELPERS=m

# --- USB 控制器 ---
CONFIG_USB_SUPPORT=y
CONFIG_USB=y
CONFIG_USB_XHCI_HCD=y
CONFIG_USB_XHCI_PLATFORM=y
CONFIG_USB_DWC3=y
CONFIG_USB_DWC3_QCOM=y

# --- IOMMU ---
CONFIG_IOMMU_SUPPORT=y
CONFIG_ARM_SMMU=y

# --- Remoteproc (ADSP) ---
CONFIG_REMOTEPROC=y
CONFIG_QCOM_Q6V5_ADSP=m
CONFIG_QCOM_Q6V5_PAS=m

# --- GLINK ---
CONFIG_RPMSG=y
CONFIG_RPMSG_QCOM_GLINK=y
CONFIG_RPMSG_QCOM_GLINK_SMEM=y

# --- 声卡驱动 (选择适合的 machine driver) ---
# RB3Gen2 使用 sc8280xp machine driver
CONFIG_SND_SOC_SC8280XP=m
CONFIG_SND_SOC_QCOM_COMMON=m
CONFIG_SND_SOC_QCOM_SDW=m
